<!-- Header -->
<mat-toolbar color="primary" class="blog-header">
  <mat-icon>article</mat-icon>
  <span class="title">{{ title }}</span>
  
  <div class="header-spacer"></div>
  
  <button mat-icon-button (click)="toggleDemo()" 
          matTooltip="Demo-Komponente anzeigen/verbergen">
    <mat-icon>{{ showDemo ? 'visibility_off' : 'visibility' }}</mat-icon>
  </button>
</mat-toolbar>

<!-- Main Content Container -->
<div class="main-container">
  
  <!-- Demo Component (Conditional Display with @if) -->
  @if (showDemo) {
    <div class="demo-section">
      <mat-card class="demo-card">
        <mat-card-header>
          <mat-card-title>Angular Konzepte Demo</mat-card-title>
          <mat-card-subtitle>Ursprüngliche Demo-Komponente</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <app-demo></app-demo>
        </mat-card-content>
      </mat-card>
    </div>
  }
  
  <!-- Blog Section -->
  <div class="blog-section">
    
    <!-- Filter Controls -->
    <div class="filter-controls">
      <mat-card class="filter-card">
        <mat-card-content>
          <div class="filter-row">
            
            <!-- Category Filter -->
            <mat-form-field appearance="outline" class="category-select">
              <mat-label>Kategorie auswählen</mat-label>
              <mat-select [(ngModel)]="selectedCategory" 
                         (selectionChange)="onCategoryChange()">
                <mat-option value="">Alle Kategorien</mat-option>
                @for (category of categories; track category) {
                  <mat-option [value]="category">{{ category }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            
            <!-- Featured Filter -->
            <button mat-raised-button 
                    [color]="showOnlyFeatured ? 'accent' : 'primary'"
                    (click)="toggleFeaturedFilter()"
                    class="featured-filter">
              <mat-icon>{{ showOnlyFeatured ? 'star' : 'star_border' }}</mat-icon>
              {{ showOnlyFeatured ? 'Alle anzeigen' : 'Nur Featured' }}
            </button>
            
            <!-- Reset Filter -->
            <button mat-raised-button color="warn" 
                    (click)="resetFilters()"
                    class="reset-filter">
              <mat-icon>refresh</mat-icon>
              Filter zurücksetzen
            </button>
            
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    
    <!-- Loading Indicator with @if -->
    @if (isLoading) {
      <div class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Blog-Posts werden geladen...</p>
      </div>
    }
    
    <!-- Blog Posts Grid with @for -->
    @if (!isLoading) {
      <div class="blog-posts-grid">
        @for (post of blogPosts; track post.id; let i = $index; let isFirst = $first; let isLast = $last; let isEven = $even) {
          <mat-card class="blog-post-card" 
                    [class.featured]="post.featured"
                    [class.first-post]="isFirst"
                    [class.last-post]="isLast"
                    [class.even-post]="isEven">
            
            <!-- Featured Badge with @if -->
            @if (post.featured) {
              <div class="featured-badge">
                <mat-icon>star</mat-icon>
                Featured
              </div>
            }
            
            <!-- Post Image -->
            <div class="post-image-container">
              <img [src]="post.imageUrl" 
                   [alt]="post.title" 
                   class="post-image"
                   loading="lazy">
            </div>
            
            <mat-card-header>
              <mat-card-title>{{ post.title }}</mat-card-title>
              <mat-card-subtitle>
                von {{ post.author }} • {{ formatDate(post.publishDate) }}
              </mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <p class="post-preview">
                {{ getPreviewContent(post.content) }}
              </p>
              
              <div class="post-meta">
                <mat-chip-set>
                  <mat-chip [color]="getCategoryColor(post.category)">
                    {{ post.category }}
                  </mat-chip>
                  @for (tag of post.tags; track tag) {
                    <mat-chip>{{ tag }}</mat-chip>
                  }
                </mat-chip-set>
              </div>
            </mat-card-content>
            
            <mat-card-actions align="end">
              <button mat-button color="primary">
                <mat-icon>read_more</mat-icon>
                Weiterlesen
              </button>
              <button mat-icon-button>
                <mat-icon>share</mat-icon>
              </button>
              <button mat-icon-button>
                <mat-icon>bookmark_border</mat-icon>
              </button>
            </mat-card-actions>
            
          </mat-card>
        } @empty {
          <!-- Empty State with @empty -->
          <div class="empty-state">
            <mat-card class="empty-card">
              <mat-card-content>
                <mat-icon class="empty-icon">inbox</mat-icon>
                <h2>Keine Blog-Posts gefunden</h2>
                <p>
                  @if (selectedCategory || showOnlyFeatured) {
                    Versuchen Sie andere Filter oder setzen Sie die Filter zurück.
                  } @else {
                    Es sind derzeit keine Blog-Posts verfügbar.
                  }
                </p>
                <button mat-raised-button color="primary" (click)="resetFilters()">
                  <mat-icon>refresh</mat-icon>
                  Filter zurücksetzen
                </button>
              </mat-card-content>
            </mat-card>
          </div>
        }
      </div>
    }
    
  </div>
  
</div>

<!-- Footer -->
<footer class="blog-footer">
  <mat-divider></mat-divider>
  <div class="footer-content">
    <p>&copy; 2024 Angular Blog - Mehmet Oezdag</p>
    <p>Erstellt mit Angular {{ getAngularVersion() }} und Angular Material</p>
  </div>
</footer>
